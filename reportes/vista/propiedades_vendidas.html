<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<head>
	<title></title>
	<script type="text/javascript" src="../../js/jquery-1.10.2.min.js"></script>
	<script type="text/javascript">
	$(document).ready(function(){
		$.ajax({
 			type: "POST",
 			url: "../control/control.php",
 			data: { "funcion" :  "reporteVendidas" },
 			success: function(data){
 				// alert(data);
 				listaTabla(data);
 			}
 		});
		$("#txtBuscaXPropiedad").keyup(function(){
 			$txtfiltroPropiedad = $("#txtBuscaXPropiedad").val();
 			
 				$.ajax({
		 			type: "POST",
		 			url: "../control/control.php",
		 			data: { "funcion" :  "filtraTablaVendidas", "txtfiltroPropiedad": $txtfiltroPropiedad},
		 			success: function(data){
		 				$("#tablaReporte").html('<tr><th>Propiedad</th><th>Suma de Rentas Generadas</th><th>Monto de Venta</th><th>Costo de Adquisición</th><th>Cantidad Generada</th><th>% Generado</th></tr>');
		 				listaTabla(data);
		 			}
		 		});
 			

 		});
	});
	function listaTabla(data){
		obj = JSON.parse(data);
		$filas = "";
		$.each( obj.Reporte, function(key) {
			$generado = (parseInt(obj.Reporte[key].rentas)+parseInt(obj.Reporte[key].valor_vendido)-parseInt(obj.Reporte[key].valor_inicial));
			$porsGenerado = (($generado/obj.Reporte[key].valor_inicial)*100).toFixed(3);
			$filas += "<tr id='fila_"+obj.Reporte[key].clave+"'>";
			$filas += "<td>"+obj.Reporte[key].nombre+"</td>";
			$filas += "<td>$ "+parseFloat(obj.Reporte[key].rentas).toFixed(2)+"</td>";
			$filas += "<td>$ "+parseFloat(obj.Reporte[key].valor_vendido).toFixed(2)+"</td>";
			$filas += "<td>$ "+parseFloat(obj.Reporte[key].valor_inicial).toFixed(2)+"</td>";
			$filas += "<td>$ "+parseFloat($generado).toFixed(2)+"</td>";
			$filas += "<td>"+$porsGenerado+" %</td>";
			
			$filas += "</tr>";
			 // propiedades.valor_inicial, propiedades.valor_vendido, SUM(cortes.`monto`) as rentas
		});
		$("#tablaReporte").append($filas);
	}
	</script>
</head>
<body>
Filtro: <br>
Propiedades: <input type="text" id="txtBuscaXPropiedad">
<br><br>
<table border="1" id="tablaReporte">
	<tr>
		<th>Propiedad</th><th>Suma de Rentas Generadas</th><th>Monto de Venta</th><th>Costo de Adquisición</th><th>Cantidad Generada</th><th>% Generado</th>
	</tr>
</table>
</body>
</html>